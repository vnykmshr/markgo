version: "3.8"

services:
  markgo:
    build:
      target: development
    environment:
      - ENVIRONMENT=development
      - LOG_LEVEL=debug
    volumes:
      - ../:/app:cached
      - /app/build
    command: ["air", "-c", ".air.toml"]
    ports:
      - "3000:3000"
      - "2345:2345"  # Delve debugger port

  # Remove production services in development
  nginx:
    profiles: ["production"]

  prometheus:
    profiles: ["production"]

  grafana:
    profiles: ["production"]
