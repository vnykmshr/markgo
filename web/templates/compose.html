{{ define "compose-content" }}
<div class="compose-page">
    <div class="container">
        <header class="page-header">
            {{ if .editing }}
            <h1 class="page-title">Edit</h1>
            <p class="page-subtitle">Update your post.</p>
            {{ else }}
            <h1 class="page-title">Compose</h1>
            <p class="page-subtitle">Write a thought, share a link, or publish an article.</p>
            {{ end }}
        </header>

        {{ if .error }}
        <div class="compose-error">
            <p>{{ .error }}</p>
        </div>
        {{ end }}

        <div class="compose-draft-notice" id="compose-draft-notice" hidden>
            <span>Draft recovered</span>
            <button type="button" class="compose-draft-discard" id="compose-draft-discard">Discard</button>
        </div>
        <div class="compose-save-warning" id="compose-save-warning" role="status" hidden>
            Draft saving unavailable — copy your work before leaving
        </div>

        <form class="compose-form" method="POST" action="{{ if .editing }}/compose/edit/{{ .slug }}{{ else }}/compose{{ end }}">
            <input type="hidden" name="_csrf" value="{{ .csrf_token }}">
            <div class="compose-field">
                <label for="content" class="compose-label">Content <span class="compose-required">*</span></label>
                <textarea
                    id="content"
                    name="content"
                    class="compose-textarea"
                    placeholder="What's on your mind? Write in Markdown..."
                    required
                    autofocus
                >{{ if .input }}{{ .input.Content }}{{ end }}</textarea>
                <div class="compose-preview-controls">
                    <button type="button" class="compose-preview-btn" aria-pressed="false">Preview</button>
                    <button type="button" class="compose-upload-btn">Upload Image</button>
                    <input type="file" class="compose-file-input" accept="image/jpeg,image/png,image/gif,image/webp" hidden>
                    <span class="upload-status"></span>
                </div>
                <div class="compose-preview-panel" aria-live="polite">
                    <div class="compose-preview-content article-content">
                        <p class="preview-placeholder">Click Preview to render your markdown.</p>
                    </div>
                </div>
            </div>

            <div class="compose-field">
                <label for="title" class="compose-label">Title <span class="compose-hint">(optional — leave empty for thoughts)</span></label>
                <input
                    type="text"
                    id="title"
                    name="title"
                    class="compose-input"
                    placeholder="Article title"
                    value="{{ if .input }}{{ .input.Title }}{{ end }}"
                >
            </div>

            <div class="compose-field">
                <label for="description" class="compose-label">Description <span class="compose-hint">(optional — used for SEO and social previews)</span></label>
                <input
                    type="text"
                    id="description"
                    name="description"
                    class="compose-input"
                    placeholder="A brief description of your post"
                    value="{{ if .input }}{{ .input.Description }}{{ end }}"
                >
            </div>

            <div class="compose-field">
                <label for="link_url" class="compose-label">Link URL <span class="compose-hint">(optional — add a URL to create a link post)</span></label>
                <input
                    type="url"
                    id="link_url"
                    name="link_url"
                    class="compose-input"
                    placeholder="https://example.com"
                    value="{{ if .input }}{{ .input.LinkURL }}{{ end }}"
                >
            </div>

            <div class="compose-field">
                <label for="tags" class="compose-label">Tags <span class="compose-hint">(optional — comma-separated)</span></label>
                <input
                    type="text"
                    id="tags"
                    name="tags"
                    class="compose-input"
                    placeholder="golang, web, tutorial"
                    value="{{ if .input }}{{ .input.Tags }}{{ end }}"
                >
            </div>

            <div class="compose-field">
                <label for="categories" class="compose-label">Categories <span class="compose-hint">(optional — comma-separated)</span></label>
                <input
                    type="text"
                    id="categories"
                    name="categories"
                    class="compose-input"
                    placeholder="technology, programming"
                    value="{{ if .input }}{{ .input.Categories }}{{ end }}"
                >
            </div>

            <div class="compose-actions">
                <button type="submit" name="draft" value="on" class="compose-submit">Save Draft</button>
                <button type="submit" name="draft" value="" class="compose-submit-secondary">{{ if .editing }}Update{{ else }}Publish{{ end }}</button>
                {{ if .editing }}
                <a href="/writing/{{ .slug }}" class="compose-cancel">Cancel</a>
                {{ else }}
                <a href="/" class="compose-cancel">Cancel</a>
                {{ end }}
            </div>
        </form>
    </div>
</div>
{{ end }}

{{ define "compose-head" }}
<meta name="description" content="Compose a new post on {{ .config.Blog.Title }}">
<meta name="robots" content="noindex, nofollow">
{{ end }}
