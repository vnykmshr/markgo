<!DOCTYPE html>
<html lang="{{ .config.Blog.Language | default "en" }}" data-color-theme="{{ .config.Blog.Theme | default "default" }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script>try{var t=localStorage.getItem("theme");if(t==="dark"||t==="light")document.documentElement.setAttribute("data-theme",t);var c=localStorage.getItem("colorTheme");if(c)document.documentElement.setAttribute("data-color-theme",c)}catch(e){}</script>

    <!-- Primary Meta Tags -->
    <title>{{ if .title }}{{ .title }}{{ else }}{{ .config.Blog.Title }}{{ end }}</title>

    {{ if not .config.SEO.Enabled }}
    {{/* Static meta tags when SEO service is disabled */}}
    <meta name="title" content="{{ if .title }}{{ .title }}{{ else }}{{ .config.Blog.Title }}{{ end }}">
    <meta name="description" content="{{ if .description }}{{ .description }}{{ else }}{{ .config.Blog.Description }}{{ end }}">
    <meta name="author" content="{{ .config.Blog.Author }}">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{{ if .article }}article{{ else }}website{{ end }}">
    <meta property="og:url" content="{{ .config.BaseURL }}{{ if .article }}/writing/{{ .article.Slug }}{{ end }}">
    <meta property="og:title" content="{{ if .title }}{{ .title }}{{ else }}{{ .config.Blog.Title }}{{ end }}">
    <meta property="og:description" content="{{ if .description }}{{ .description }}{{ else if .article }}{{ .article.Excerpt }}{{ else }}{{ .config.Blog.Description }}{{ end }}">
    <meta property="og:site_name" content="{{ .config.Blog.Title }}">
    <meta property="og:locale" content="{{ .config.Blog.Language | default "en_US" }}">
    {{ if .article }}
    <meta property="og:image" content="{{ .config.BaseURL }}/static/img/og-article-default.png">
    <meta property="og:image:alt" content="{{ .article.Title }} - {{ .config.Blog.Title }}">
    {{ else }}
    <meta property="og:image" content="{{ .config.BaseURL }}/static/img/og-default.png">
    <meta property="og:image:alt" content="{{ .config.Blog.Title }} - {{ .config.Blog.Description }}">
    {{ end }}
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{{ .config.BaseURL }}{{ if .article }}/writing/{{ .article.Slug }}{{ end }}">
    <meta name="twitter:title" content="{{ if .title }}{{ .title }}{{ else }}{{ .config.Blog.Title }}{{ end }}">
    <meta name="twitter:description" content="{{ if .description }}{{ .description }}{{ else if .article }}{{ .article.Excerpt }}{{ else }}{{ .config.Blog.Description }}{{ end }}">
    {{ if .article }}
    <meta name="twitter:image" content="{{ .config.BaseURL }}/static/img/og-article-default.png">
    <meta name="twitter:image:alt" content="{{ .article.Title }} - {{ .config.Blog.Title }}">
    {{ else }}
    <meta name="twitter:image" content="{{ .config.BaseURL }}/static/img/og-default.png">
    <meta name="twitter:image:alt" content="{{ .config.Blog.Title }} - {{ .config.Blog.Description }}">
    {{ end }}
    {{/* Twitter social meta tags disabled - Social config not implemented yet
    {{ if .config.Social.TwitterHandle }}
    <meta name="twitter:site" content="@{{ .config.Social.TwitterHandle }}">
    <meta name="twitter:creator" content="@{{ .config.Social.TwitterHandle }}">
    {{ end }}
    */}}

    <!-- Article specific meta -->
    {{ if .article }}
    <meta property="article:author" content="{{ .config.Blog.Author }}">
    <meta property="article:published_time" content="{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}">
    {{ if .article.LastModified }}
    <meta property="article:modified_time" content="{{ .article.LastModified.Format "2006-01-02T15:04:05Z07:00" }}">
    {{ end }}
    <meta property="article:section" content="{{ if .article.Categories }}{{ index .article.Categories 0 }}{{ else }}Blog{{ end }}">
    {{ range .article.Tags }}
    <meta property="article:tag" content="{{ . }}">
    {{ end }}
    {{ range .article.Categories }}
    <meta property="article:section" content="{{ . }}">
    {{ end }}
    {{ if .article.ReadingTime }}
    <meta name="twitter:label1" content="Reading time">
    <meta name="twitter:data1" content="{{ .article.ReadingTime }} min read">
    {{ end }}
    {{ if .article.WordCount }}
    <meta name="twitter:label2" content="Word count">
    <meta name="twitter:data2" content="{{ .article.WordCount }} words">
    {{ end }}
    {{ end }}

    <!-- Additional SEO meta -->
    <meta name="theme-color" content="#1a1a1a">
    <meta name="msapplication-navbutton-color" content="#1a1a1a">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    {{ end }}

    <!-- Enhanced SEO Service Integration -->
    {{ if .config.SEO.Enabled }}
        {{/* Enhanced meta tags from SEO service */}}
        {{ if .seoMetaTags }}{{ renderMetaTags .seoMetaTags }}{{ end }}

        {{/* JSON-LD Structured Data */}}
        {{ if .articleSchema }}{{ generateJsonLD .articleSchema }}{{ end }}
        {{ if .websiteSchema }}{{ generateJsonLD .websiteSchema }}{{ end }}
        {{ if .breadcrumbSchema }}{{ generateJsonLD .breadcrumbSchema }}{{ end }}

        {{/* SEO Verification Tags */}}
        {{ if .config.SEO.GoogleSiteVerify }}
        <meta name="google-site-verification" content="{{ .config.SEO.GoogleSiteVerify }}">
        {{ end }}
        {{ if .config.SEO.BingSiteVerify }}
        <meta name="msvalidate.01" content="{{ .config.SEO.BingSiteVerify }}">
        {{ end }}
        {{ if .config.SEO.FacebookAppID }}
        <meta property="fb:app_id" content="{{ .config.SEO.FacebookAppID }}">
        {{ end }}
    {{ else }}
        {{/* Fallback Schema.org structured data */}}
        {{ if .article }}
        <meta itemprop="name" content="{{ .article.Title }}">
        <meta itemprop="description" content="{{ if .article.Description }}{{ .article.Description }}{{ else }}{{ seoExcerpt .article.Content 160 }}{{ end }}">
        <meta itemprop="image" content="{{ .config.BaseURL }}/static/img/og-article-default.png">
        <meta itemprop="author" content="{{ .config.Blog.Author }}">
        <meta itemprop="datePublished" content="{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}">
        {{ if .article.LastModified }}
        <meta itemprop="dateModified" content="{{ .article.LastModified.Format "2006-01-02T15:04:05Z07:00" }}">
        {{ end }}
        {{ end }}
    {{ end }}

    <!-- Favicon -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/static/img/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/img/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/img/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/img/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/static/img/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/static/img/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/static/img/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/static/img/apple-touch-icon-152x152.png" />

    <link rel="icon" type="image/png" href="/static/img/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/static/img/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/static/img/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/static/img/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/static/img/favicon-128.png" sizes="128x128" />

    <meta name="application-name" content="&nbsp;"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/static/img/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/static/img/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/static/img/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/static/img/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/static/img/mstile-310x310.png" />

    <link rel="manifest" href="/manifest.json">

    <!-- Feeds -->
    <link rel="alternate" type="application/rss+xml" title="{{ .config.Blog.Title }} - RSS Feed" href="/feed.xml">
    <link rel="alternate" type="application/feed+json" title="{{ .config.Blog.Title }} - JSON Feed" href="/feed.json">

    <!-- Canonical URL (only when handler provides a path — omit for 404/admin/compose) -->
    {{ if .canonicalPath }}<link rel="canonical" href="{{ .config.BaseURL }}{{ .canonicalPath }}">{{ end }}

    <!-- Stylesheets — all loaded upfront for SPA content swaps -->
    <link rel="stylesheet" href="/static/css/fonts.css">
    <link rel="stylesheet" href="/static/css/github-dark.min.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/components.css">
    {{ if .config.Blog.Style }}<link rel="stylesheet" href="/static/css/themes/{{ .config.Blog.Style }}.css">{{ end }}
    <link rel="stylesheet" href="/static/css/cards.css">
    <link rel="stylesheet" href="/static/css/feed.css">
    <link rel="stylesheet" href="/static/css/article.css">
    <link rel="stylesheet" href="/static/css/articles.css">
    <link rel="stylesheet" href="/static/css/search.css">
    <link rel="stylesheet" href="/static/css/about.css">
    <link rel="stylesheet" href="/static/css/taxonomy.css">
    <link rel="stylesheet" href="/static/css/compose.css">
    <link rel="stylesheet" href="/static/css/admin.css">
    <!-- 404.css provides shared .error-content styles (used by 404, 500, offline) -->
    <link rel="stylesheet" href="/static/css/404.css">
    <link rel="stylesheet" href="/static/css/toast.css">
    <link rel="stylesheet" href="/static/css/fab.css">
    <link rel="stylesheet" href="/static/css/compose-sheet.css">
    <link rel="stylesheet" href="/static/css/login.css">
    <link rel="stylesheet" href="/static/css/bottom-nav.css">
    <link rel="stylesheet" href="/static/css/popovers.css">

    {{ if .csrf_token }}<meta name="csrf-token" content="{{ .csrf_token }}">{{ end }}

    <!-- Additional head content -->
    {{ $tpl := .template | default "feed" }}
    {{ if eq $tpl "feed" }}{{ template "feed-head" . }}{{ end }}
    {{ if eq $tpl "compose" }}{{ template "compose-head" . }}{{ end }}
    {{ if eq $tpl "articles" }}{{ template "articles-head" . }}{{ end }}
    {{ if eq $tpl "article" }}{{ template "article-head" . }}{{ end }}
    {{ if eq $tpl "search" }}{{ template "search-head" . }}{{ end }}
    {{ if eq $tpl "about" }}{{ template "about-head" . }}{{ end }}
    {{ if eq $tpl "tags" }}{{ template "tags-head" . }}{{ end }}
    {{ if eq $tpl "categories" }}{{ template "categories-head" . }}{{ end }}
    {{ if eq $tpl "tag" }}{{ template "tag-head" . }}{{ end }}
    {{ if eq $tpl "category" }}{{ template "category-head" . }}{{ end }}
    {{ if eq $tpl "admin_home" }}{{ template "admin_home-head" . }}{{ end }}
    {{ if eq $tpl "drafts" }}{{ template "drafts-head" . }}{{ end }}
    {{ if eq $tpl "404" }}{{ template "404-head" . }}{{ end }}
    {{ if eq $tpl "500" }}{{ template "500-head" . }}{{ end }}
    {{ if eq $tpl "offline" }}{{ template "offline-head" . }}{{ end }}
</head>
<body data-template="{{ .template | default "feed" }}" class="{{- $tpl := .template | default "feed" -}}
    {{- if eq $tpl "articles" -}}articles-page
    {{- else if eq $tpl "article" -}}article-page-body
    {{- else if eq $tpl "search" -}}search-page
    {{- else if eq $tpl "about" -}}about-page
    {{- else if eq $tpl "tags" -}}tags-page
    {{- else if eq $tpl "categories" -}}categories-page
    {{- else if eq $tpl "tag" -}}tag-page
    {{- else if eq $tpl "category" -}}category-page
    {{- else if eq $tpl "feed" -}}feed-page
    {{- else if eq $tpl "compose" -}}compose-page
    {{- else if eq $tpl "admin_home" -}}admin-page
    {{- else if eq $tpl "drafts" -}}drafts-page
    {{- else if eq $tpl "404" -}}error-page
    {{- else if eq $tpl "500" -}}error-page
    {{- else if eq $tpl "offline" -}}error-page
    {{- end -}}">
    <a class="skip-link" href="#main-content">Skip to content</a>
    <div id="route-announcer" aria-live="polite" class="sr-only"></div>
    <!-- Header -->
    <header class="site-header">
        <nav class="navbar">
            <div class="container">
                <div class="navbar-brand">
                    <a href="/" class="brand-link">
                        <span class="brand-title">{{ .config.Blog.Title }}</span>
                        {{ if .config.Blog.Tagline }}<p class="brand-subtitle">{{ .config.Blog.Tagline }}</p>{{ end }}
                    </a>
                </div>

                <div class="navbar-menu" id="navbar-menu">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a href="/writing" class="nav-link">Writing</a>
                        </li>
                        <li class="nav-item">
                            <a href="/about" class="nav-link">About</a>
                        </li>
                        {{ if and (ne .config.Admin.Username "") (ne .config.Admin.Password "") }}
                        <li class="nav-item">
                            <a href="/compose" class="nav-link">Compose</a>
                        </li>
                        {{ end }}
                    </ul>
                </div>

                <div class="navbar-actions">
                    <button class="nav-action-btn search-trigger" aria-label="Search" aria-expanded="false" aria-haspopup="true" title="Search">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                        <span class="sr-only">Search</span>
                    </button>
                    <button class="nav-action-btn subscribe-trigger" aria-label="Subscribe" aria-expanded="false" aria-haspopup="true" title="Subscribe">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M3.429 2.776c7.729 0 10.367 2.714 10.367 10.368H11.07c0-5.585-1.909-7.494-7.494-7.494V2.776Z"/>
                            <path d="M3.429 6.205c4.373 0 6.938 2.565 6.938 6.938h-2.727c0-2.31-1.9-4.21-4.21-4.21V6.205Z"/>
                            <circle cx="4.571" cy="11.429" r="1.143"/>
                        </svg>
                        <span class="sr-only">Subscribe</span>
                    </button>
                    {{ if and (ne .config.Admin.Username "") (ne .config.Admin.Password "") }}
                    {{ if .authenticated }}
                    <button class="nav-action-btn admin-trigger" aria-label="Account" aria-expanded="false" aria-haspopup="true" title="Account">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                        </svg>
                    </button>
                    {{ else }}{{ if .auth_required }}{{ else }}
                    <button class="nav-action-btn login-trigger" aria-label="Sign in" title="Sign in">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                        </svg>
                    </button>
                    {{ end }}{{ end }}
                    {{ end }}
                    <button class="theme-btn nav-action-btn" aria-label="Appearance" aria-expanded="false" aria-haspopup="true" title="Appearance">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M12.433 10.07C14.133 10.585 16 11.15 16 8a8 8 0 1 0-8 8c.834 0 1.543-.09 2.12-.244-.296-.378-.484-.846-.484-1.356 0-1.205.978-2.183 2.183-2.183.356 0 .693.086.998.244zM5 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm1-3a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0zm5.5 4.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                        </svg>
                    </button>
                    <button class="navbar-toggle" id="navbar-toggle" aria-label="Toggle navigation" aria-expanded="false">
                        <span class="toggle-line"></span>
                        <span class="toggle-line"></span>
                        <span class="toggle-line"></span>
                    </button>
                </div>
                {{ if and (ne .config.Admin.Username "") (ne .config.Admin.Password "") }}
                {{ if .authenticated }}
                <div class="admin-popover" id="admin-popover" hidden>
                    <nav class="admin-popover-nav" aria-label="Admin">
                        <a href="/admin" class="admin-popover-link">Dashboard</a>
                        <a href="/admin/drafts" class="admin-popover-link">Drafts</a>
                    </nav>
                    <div class="admin-popover-divider"></div>
                    <a href="/logout" class="admin-popover-link admin-popover-logout">Sign out</a>
                </div>
                {{ else }}{{ if .auth_required }}{{ else }}
                <div class="login-popover" id="login-popover" hidden>
                    <form class="login-popover-form login-form" method="POST" action="/login">
                        <input type="hidden" name="_csrf" value="{{ .csrf_token }}">
                        <input type="hidden" name="next" value="{{ .login_next }}">
                        <label for="popover-username" class="sr-only">Username</label>
                        <input type="text" name="username" id="popover-username" class="login-popover-input" placeholder="Username" autocomplete="username" required>
                        <label for="popover-password" class="sr-only">Password</label>
                        <input type="password" name="password" id="popover-password" class="login-popover-input" placeholder="Password" autocomplete="current-password" required>
                        <button type="submit" class="login-popover-submit">Sign in</button>
                        <div class="login-error" hidden></div>
                    </form>
                </div>
                {{ end }}{{ end }}
                {{ end }}
                <div class="search-popover" id="search-popover" hidden>
                    <form id="search-popover-form" class="search-popover-form">
                        <input type="search" class="search-popover-input" placeholder="Search posts…" autocomplete="off">
                    </form>
                    <div class="search-popover-hint">Press Enter to search</div>
                </div>
                <div class="subscribe-popover" id="subscribe-popover" hidden>
                    <div class="subscribe-popover-label">Subscribe</div>
                    <button class="subscribe-popover-btn" id="copy-rss-url">
                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M3.429 2.776c7.729 0 10.367 2.714 10.367 10.368H11.07c0-5.585-1.909-7.494-7.494-7.494V2.776Z"/><path d="M3.429 6.205c4.373 0 6.938 2.565 6.938 6.938h-2.727c0-2.31-1.9-4.21-4.21-4.21V6.205Z"/><circle cx="4.571" cy="11.429" r="1.143"/></svg>
                        Copy RSS URL
                    </button>
                    <button class="subscribe-popover-btn" id="copy-json-url">
                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5ZM3 8.062C3 6.76 4.235 5.765 5.53 5.886a26.58 26.58 0 0 0 4.94 0C11.765 5.765 13 6.76 13 8.062v1.157a.933.933 0 0 1-.765.935c-.845.147-2.34.346-4.235.346-1.895 0-3.39-.2-4.235-.346A.933.933 0 0 1 3 9.219V8.062Zm4.542-.827a.25.25 0 0 0-.217.068l-.92.9a25.11 25.11 0 0 1-1.871-.183.25.25 0 0 0-.068.495c.55.076 1.232.149 2.02.193a.25.25 0 0 0 .189-.071l.754-.736.847 1.71a.25.25 0 0 0 .404.062l.932-.97a25.286 25.286 0 0 0 1.922-.188.25.25 0 0 0-.068-.495c-.538.074-1.207.145-1.98.189a.25.25 0 0 0-.166.076l-.754.785-.842-1.7a.25.25 0 0 0-.182-.135Z"/><path d="M1 4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4Zm1 0v8h12V4H2Z"/></svg>
                        Copy JSON Feed URL
                    </button>
                </div>
                <div class="theme-popover" id="theme-popover" hidden>
                    <div class="theme-section">
                        <div class="theme-section-label">Mode</div>
                        <div class="theme-mode-group" role="radiogroup" aria-label="Color mode">
                            <button class="theme-mode-btn" role="radio" aria-checked="false" data-mode="light">Light</button>
                            <button class="theme-mode-btn" role="radio" aria-checked="false" data-mode="dark">Dark</button>
                            <button class="theme-mode-btn" role="radio" aria-checked="true" data-mode="auto">Auto</button>
                        </div>
                    </div>
                    <div class="theme-section">
                        <div class="theme-section-label">Color</div>
                        <div class="theme-color-group" role="radiogroup" aria-label="Color theme">
                            <button class="color-swatch" role="radio" aria-checked="false" data-color="default" aria-label="Default blue" title="Default"></button>
                            <button class="color-swatch" role="radio" aria-checked="false" data-color="ocean" aria-label="Ocean teal" title="Ocean"></button>
                            <button class="color-swatch" role="radio" aria-checked="false" data-color="forest" aria-label="Forest green" title="Forest"></button>
                            <button class="color-swatch" role="radio" aria-checked="false" data-color="sunset" aria-label="Sunset orange" title="Sunset"></button>
                            <button class="color-swatch" role="radio" aria-checked="false" data-color="berry" aria-label="Berry purple" title="Berry"></button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="main-content">
        {{ if .breadcrumbs }}
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <ol class="breadcrumb-list">
                {{ range .breadcrumbs }}
                {{ if .URL }}<li class="breadcrumb-item"><a href="{{ .URL }}">{{ .Name }}</a></li>
                {{ else }}<li class="breadcrumb-item breadcrumb-current" aria-current="page">{{ .Name }}</li>
                {{ end }}
                {{ end }}
            </ol>
        </nav>
        {{ end }}
        {{ $tpl := .template | default "feed" }}
        {{ if .auth_required }}
        <div class="auth-gate">
            <div class="auth-gate-card">
                <div class="auth-gate-lock">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                    </svg>
                </div>
                <h2 class="auth-gate-title" id="auth-gate-title">Sign in to continue</h2>
                <form class="auth-gate-form login-form" id="auth-gate-form" method="POST" action="/login" aria-labelledby="auth-gate-title">
                    <input type="hidden" name="_csrf" value="{{ .csrf_token }}">
                    <input type="hidden" name="next" value="{{ .login_next }}">
                    <label for="auth-gate-username" class="sr-only">Username</label>
                    <input type="text" name="username" id="auth-gate-username" class="auth-gate-input" placeholder="Username" autocomplete="username" required>
                    <label for="auth-gate-password" class="sr-only">Password</label>
                    <input type="password" name="password" id="auth-gate-password" class="auth-gate-input" placeholder="Password" autocomplete="current-password" required>
                    <button type="submit" class="auth-gate-submit">Sign in</button>
                    <div class="login-error" hidden></div>
                </form>
            </div>
        </div>
        {{ else }}
        {{ if eq $tpl "feed" }}{{ template "feed-content" . }}{{ end }}
        {{ if eq $tpl "compose" }}{{ template "compose-content" . }}{{ end }}
        {{ if eq $tpl "articles" }}{{ template "articles-content" . }}{{ end }}
        {{ if eq $tpl "article" }}{{ template "article-content" . }}{{ end }}
        {{ if eq $tpl "search" }}{{ template "search-content" . }}{{ end }}
        {{ if eq $tpl "about" }}{{ template "about-content" . }}{{ end }}
        {{ if eq $tpl "tags" }}{{ template "tags-content" . }}{{ end }}
        {{ if eq $tpl "tag" }}{{ template "tag-content" . }}{{ end }}
        {{ if eq $tpl "categories" }}{{ template "categories-content" . }}{{ end }}
        {{ if eq $tpl "category" }}{{ template "category-content" . }}{{ end }}
        {{ if eq $tpl "admin_home" }}{{ template "admin_home-content" . }}{{ end }}
        {{ if eq $tpl "drafts" }}{{ template "drafts-content" . }}{{ end }}
        {{ if eq $tpl "404" }}{{ template "404-content" . }}{{ end }}
        {{ if eq $tpl "500" }}{{ template "500-content" . }}{{ end }}
        {{ if eq $tpl "offline" }}{{ template "offline-content" . }}{{ end }}
        {{ end }}
    </main>

    <!-- Bottom Navigation (mobile only, hidden via CSS on desktop) -->
    <nav class="bottom-nav" aria-label="Main navigation">
        <a href="/" class="bottom-nav-item" data-nav="home">
            <svg width="22" height="22" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146z"/></svg>
            <span>Home</span>
        </a>
        <a href="/writing" class="bottom-nav-item" data-nav="writing">
            <svg width="22" height="22" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z"/></svg>
            <span>Writing</span>
        </a>
        {{ if and (ne .config.Admin.Username "") (ne .config.Admin.Password "") }}
        <button class="bottom-nav-item bottom-nav-compose" data-nav="compose" aria-label="New post">
            <span class="bottom-nav-icon">
                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" viewBox="0 0 24 24" aria-hidden="true"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            </span>
        </button>
        {{ end }}
        <a href="/search" class="bottom-nav-item" data-nav="search">
            <svg width="22" height="22" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></svg>
            <span>Search</span>
        </a>
        <a href="/about" class="bottom-nav-item" data-nav="about">
            <svg width="22" height="22" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
            <span>About</span>
        </a>
    </nav>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <nav class="footer-nav" aria-label="Footer navigation">
                <a href="/feed.xml" class="footer-link footer-subscribe">Subscribe</a>
                <a href="/tags" class="footer-link">Tags</a>
                <a href="/categories" class="footer-link">Categories</a>
                <a href="/about" class="footer-link">About</a>
                <a href="/writing" class="footer-link">Writing</a>
            </nav>
            <p class="footer-colophon">
                &copy; {{ now.Year }} {{ .config.Blog.Author }} · Written in Markdown, published with <a href="https://github.com/vnykmshr/markgo" target="_blank" rel="noopener">MarkGo</a> · <span class="footer-version">{{ .app_version }}</span>
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/static/js/highlight.min.js" defer></script>
    <script type="module" src="/static/js/app.js"></script>

    <!-- Additional scripts -->
    {{ block "scripts" . }}{{ end }}

</body>
</html>
