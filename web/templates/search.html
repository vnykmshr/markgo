{{ define "search-content" }}
<div class="search-page">
    <div class="container">
        <!-- Search Header -->
        <header class="page-header">
            <h1 class="page-title">Search</h1>
        </header>

        <!-- Search Form -->
        <div class="search-form-container">
            <form class="search-form" method="GET" action="/search">
                <div class="search-input-group">
                    <input
                        type="search"
                        name="q"
                        class="search-input"
                        placeholder="Search posts..."
                        value="{{ .query }}"
                        autocomplete="off"
                        autofocus
                    />
                    <button type="submit" class="search-button">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                    </button>
                </div>
                {{ if .query }}
                <a href="/search" class="search-clear">Clear search</a>
                {{ end }}
            </form>

            {{ if not .query }}
            <p class="search-context">Search across {{ .totalCount }} posts</p>
            {{ end }}
        </div>

        <!-- Search Results -->
        {{ if .query }}
            {{ if .results }}
            <div class="card-stream">
                {{ range .results }}
                    {{ if eq .Article.Type "thought" }}
                        {{ template "card-thought" .Article }}
                    {{ else if eq .Article.Type "link" }}
                        {{ template "card-link" .Article }}
                    {{ else }}
                        {{ template "card-article" .Article }}
                    {{ end }}
                {{ end }}
            </div>
            {{ else }}
            <div class="search-empty">
                <p>No results for "{{ .query }}"</p>
                <a href="/articles" class="page-back-link">Browse writing â†’</a>
            </div>
            {{ end }}
        {{ end }}
    </div>
</div>

<!-- Structured Data -->
{{ if .query }}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "SearchResultsPage",
    "name": "Search Results for {{ .query }}",
    "url": "{{ .config.BaseURL }}/search?q={{ .query }}",
    "mainEntity": {
        "@type": "ItemList",
        "numberOfItems": {{ .count }},
        "itemListElement": [
            {{ range $index, $result := .results }}
            {{ if $index }},{{ end }}
            {
                "@type": "BlogPosting",
                "position": {{ add $index 1 }},
                "headline": "{{ displayTitle $result.Article }}",
                "description": "{{ $result.Article.Excerpt }}",
                "url": "{{ $.config.BaseURL }}/articles/{{ $result.Article.Slug }}",
                "datePublished": "{{ $result.Article.Date.Format "2006-01-02T15:04:05Z07:00" }}",
                "author": {
                    "@type": "Person",
                    "name": "{{ $.config.Blog.Author }}"
                }
            }
            {{ end }}
        ]
    }
}
</script>
{{ end }}
{{ end }}

{{ define "search-head" }}
<meta name="description" content="{{ if .query }}Search results for {{ .query }} on {{ .config.Blog.Title }}{{ else }}Search posts on {{ .config.Blog.Title }}{{ end }}">
{{ if .query }}
<meta name="robots" content="noindex, follow">
{{ end }}

{{ end }}
