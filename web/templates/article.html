{{ define "article-content" }}
<div class="page-container">
    <article class="article-detail">
        <div class="container">
            {{ if eq .article.Type "thought" }}
            <!-- Thought detail -->
            <header class="article-header article-header-thought">
                <div class="article-meta">
                    <time class="article-date" datetime="{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}">
                        {{ relativeTime .article.Date }}
                    </time>
                </div>
            </header>
            <div class="article-content article-content-thought">
                <div class="thought-accent"></div>
                <div class="thought-body">
                    {{ if .article.ProcessedContent }}
                        {{ .article.ProcessedContent | safeHTML }}
                    {{ else }}
                        {{ .article.Content | safeHTML }}
                    {{ end }}
                </div>
            </div>

            {{ else if eq .article.Type "link" }}
            <!-- Link detail -->
            <header class="article-header">
                <div class="article-meta">
                    <time class="article-date" datetime="{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}">
                        {{ .article.Date.Format "Jan 2, 2006" }}
                    </time>
                </div>
                {{ if .article.Title }}
                <h1 class="article-title">{{ .article.Title }}</h1>
                {{ end }}
                {{ if .article.LinkURL }}
                <a href="{{ .article.LinkURL }}" class="article-link-pill" target="_blank" rel="noopener">
                    <span class="article-link-domain">{{ extractDomain .article.LinkURL }}</span>
                    <span class="article-link-arrow">→</span>
                </a>
                {{ end }}
            </header>
            <div class="article-content">
                {{ if .article.ProcessedContent }}
                    {{ .article.ProcessedContent | safeHTML }}
                {{ else }}
                    {{ .article.Content | safeHTML }}
                {{ end }}
            </div>

            {{ else }}
            <!-- Article detail -->
            <header class="article-header">
                <div class="article-meta">
                    <time class="article-date" datetime="{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}">
                        {{ .article.Date.Format "Jan 2, 2006" }}
                    </time>
                    <span class="article-reading-time">{{ .article.ReadingTime }} min read</span>
                </div>
                {{ if .article.Title }}
                <h1 class="article-title">{{ .article.Title }}</h1>
                {{ end }}
                {{ if .article.Description }}
                <p class="article-description">{{ .article.Description }}</p>
                {{ end }}
            </header>
            <div class="content-separator"></div>
            <div class="article-content">
                {{ if .article.ProcessedContent }}
                    {{ .article.ProcessedContent | safeHTML }}
                {{ else }}
                    {{ .article.Content | safeHTML }}
                {{ end }}
            </div>
            {{ end }}

            <!-- Tags (all types) -->
            {{ if .article.Tags }}
            <div class="article-tags">
                {{ range .article.Tags }}
                <a href="/tags/{{ . | urlquery }}" class="feed-tag">{{ . }}</a>
                {{ end }}
            </div>
            {{ end }}

            <!-- Footer -->
            <footer class="article-footer">
                {{ if .authenticated }}
                <div class="article-admin-actions">
                    <a href="/compose/edit/{{ .article.Slug }}" class="article-edit-link">Edit</a>
                </div>
                {{ end }}
                <div class="content-separator"></div>
                <div class="article-footer-content">
                    <a href="/writing" class="page-back-link">← Writing</a>
                    {{ if .article.LastModified }}
                    <p class="article-last-modified">
                        Updated <time datetime="{{ .article.LastModified.Format "2006-01-02T15:04:05Z07:00" }}">
                            {{ .article.LastModified.Format "Jan 2, 2006" }}
                        </time>
                    </p>
                    {{ end }}
                </div>
                {{ if .config.Blog.AuthorEmail }}
                <p class="article-reply">
                    Have thoughts? <a href="mailto:{{ .config.Blog.AuthorEmail }}?subject=Re: {{ displayTitle .article }}">Reply by email</a>
                </p>
                {{ end }}
            </footer>
        </div>
    </article>
</div>

<!-- Structured Data -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "{{ displayTitle .article }}",
    "description": "{{ if .article.Description }}{{ .article.Description }}{{ else }}{{ .article.Excerpt }}{{ end }}",
    "image": "{{ .config.BaseURL }}/static/images/default-article.jpg",
    "url": "{{ .config.BaseURL }}/writing/{{ .article.Slug }}",
    "datePublished": "{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}",
    {{ if .article.LastModified }}
    "dateModified": "{{ .article.LastModified.Format "2006-01-02T15:04:05Z07:00" }}",
    {{ end }}
    "author": {
        "@type": "Person",
        "name": "{{ if .article.Author }}{{ .article.Author }}{{ else }}{{ .config.Blog.Author }}{{ end }}",
        "email": "{{ .config.Blog.AuthorEmail }}",
        "url": "{{ .config.BaseURL }}"
    },
    "publisher": {
        "@type": "Organization",
        "name": "{{ .config.Blog.Title }}",
        "url": "{{ .config.BaseURL }}",
        "logo": {
            "@type": "ImageObject",
            "url": "{{ .config.BaseURL }}/static/img/apple-touch-icon.png"
        }
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ .config.BaseURL }}/writing/{{ .article.Slug }}"
    },
    "keywords": "{{ join ", " .article.Tags }}",
    "articleSection": "{{ if .article.Categories }}{{ index .article.Categories 0 }}{{ else }}Technology{{ end }}",
    "wordCount": {{ .article.WordCount }},
    "timeRequired": "PT{{ .article.ReadingTime }}M"
}
</script>
{{ end }}

{{ define "article-head" }}
<meta name="description" content="{{ if .article.Description }}{{ .article.Description }}{{ else }}{{ .article.Excerpt }}{{ end }}">
<meta name="keywords" content="{{ join ", " .article.Tags }}">
<meta name="author" content="{{ if .article.Author }}{{ .article.Author }}{{ else }}{{ .config.Blog.Author }}{{ end }}">

<!-- Open Graph -->
<meta property="og:type" content="article">
<meta property="og:title" content="{{ displayTitle .article }}">
<meta property="og:description" content="{{ if .article.Description }}{{ .article.Description }}{{ else }}{{ .article.Excerpt }}{{ end }}">
<meta property="og:url" content="{{ .config.BaseURL }}/writing/{{ .article.Slug }}">
<meta property="article:published_time" content="{{ .article.Date.Format "2006-01-02T15:04:05Z07:00" }}">
{{ if .article.LastModified }}
<meta property="article:modified_time" content="{{ .article.LastModified.Format "2006-01-02T15:04:05Z07:00" }}">
{{ end }}
<meta property="article:author" content="{{ if .article.Author }}{{ .article.Author }}{{ else }}{{ .config.Blog.Author }}{{ end }}">
{{ range .article.Tags }}
<meta property="article:tag" content="{{ . }}">
{{ end }}

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ displayTitle .article }}">
<meta name="twitter:description" content="{{ if .article.Description }}{{ .article.Description }}{{ else }}{{ .article.Excerpt }}{{ end }}">

{{ end }}
